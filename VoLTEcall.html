<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Call Flow Diagram Generator</title>
    <style>
        .network, .status {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        label {
            display: block;
            margin: 10px 0 5px;
        }
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        #mscDiagram {
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="network">
        <h2>Call Type</h2>
        <form>
            <label for="network">Choose a call type:</label>
            <select id="network" name="network">
                <option value="Registration">Registration</option>
                <option value="Third-party Registration">Third-party Registration</option>
                <option value="VoLTE to VoLTE call">VoLTE to VoLTE call</option>
                <option value="VoLTE to CS(Pure) call">VoLTE to CS(Pure) call</option>
                <option value="CS to VoLTE call">CS to VoLTE call</option>
            </select>
        </form>
    </div>

    <!-- Call Status -->
    <div class="status" id="callStatus">Call Flow not started</div>

    <!-- Start Call Button -->
    <button onclick="startCall()">Start Call Flow</button>

    <!-- Placeholder for MSC Diagram -->
    <div id="mscDiagram"></div>

    <!-- Include mscgen.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/raphael@2.3.0/raphael.min.js"></script>

    <script>
        function startCall() {
            // Get the selected call type
            const callType = document.getElementById("network").value;

            // Update call status
            document.getElementById("callStatus").textContent = `Call Flow Started: ${callType}`;

            // Generate the MSC script based on the selected call type
            const mscScript = generateMscScript(callType);

            // Render the MSC diagram
            renderMscDiagram(mscScript);
        }

        function generateMscScript(callType) {
            let mscScript = "";

            // Define MSC script for each call type
            switch (callType) {
                case "Registration":
                    mscScript = `
                        msc {
                            UE,PCSCF,ICSCF,SCSCF,HSS;

                               UE -> PCSCF [label="Register"];
                               PCSCF -> ICSCF  [label="Register"];
                               ICSCF -> HSS [label="UAR"];
                               HSS->ICSCF [label="UAA"];
                               ICSCF->HSS [label="MAR"];
                               HSS->ICSCF [label="MAA"];
                               ICSCF->PCSCF,"*"->UE [label="401 Un Authorized"];
                               UE->PCSCF [label="Register"];
                               PCSCF->ICSCF [label="Register"];
                               ICSCF->HSS [label="UAR"]; 
                               HSS->ICSCF [label="UAA"];
                               ICSCF->SCSCF [label="Register"];
                               SCSCF->HSS [label="SAR"];
                               HSS->SCSCF [label="SAA"];
                               SCSCF->PCSCF,"*"->UE [label="200OK"];
 }
  `;
                    break;

                case "Third-party Registration":
                    mscScript = `
                        msc {
                            UE, AS, HSS;

                            UE -> AS [label="Register Request"];
                            AS -> HSS [label="Auth Request"];
                            HSS -> AS [label="Auth Response"];
                            AS -> UE [label="Register Response"];
                        }
                    `;
                    break;

                case "VoLTE to VoLTE call":
                    mscScript = `
                        msc {
                            UE1, IMS, UE2;

                            UE1 -> IMS [label="Invite"];
                            IMS -> UE2 [label="Invite"];
                            UE2 -> IMS [label="180 Ringing"];
                            IMS -> UE1 [label="180 Ringing"];
                            UE2 -> IMS [label="200 OK"];
                            IMS -> UE1 [label="200 OK"];
                            UE1 -> IMS [label="ACK"];
                            IMS -> UE2 [label="ACK"];
                        }
                    `;
                    break;

                // Add more cases for other call types...

                default:
                    mscScript = `msc { a, b; a => b [label="No diagram available"]; }`;
                    break;
            }

            return mscScript;
        }

        function renderMscDiagram(mscScript) {
            // Render the MSC diagram
            mscgenjs.render(
                {
                    elementId: "mscDiagram",
                    script: mscScript,
                    language: "mscgen",
                },
                function (pError) {
                    if (pError) {
                        console.error("Error rendering MSC diagram:", pError);
                    }
                }
            );
        }
    </script>
</body>
</html>
