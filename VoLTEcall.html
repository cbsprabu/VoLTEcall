<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Call Flow Diagram</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .msc-container {
            margin: 20px;
        }
        .msc-line {
            stroke: #000;
            stroke-width: 2;
        }
        .msc-arrow {
            stroke: #000;
            stroke-width: 2;
            marker-end: url(#arrowhead);
        }
        .msc-label {
            font-size: 14px;
            fill: #000;
        }
    </style>
</head>
<body>

    <!-- Call Type Selection -->
    <div class="network">
        <h2>Call Type</h2>
        <form>
            <label for="network">Choose a call type:</label>
            <select id="network" name="network">
                <option value="Registration">Registration</option>
                <option value="Third-party Registration">Third-party Registration</option>
                <option value="VoLTE to VoLTE call">VoLTE to VoLTE call</option>
                <option value="VoLTE to CS(Pure) call">VoLTE to CS(Pure) call</option>
                <option value="CS to VoLTE call">CS to VoLTE call</option>
            </select>
        </form>
    </div>

    <!-- Call Status -->
    <div class="status" id="callStatus">Call Flow not started</div>

    <!-- Start Call Button -->
    <button onclick="startCall()">Start Call Flow</button>

    <!-- Container for MSC Diagram -->
    <div id="callFlowDiagram">
        <!-- The diagram will be displayed here -->
    </div>

    <script>
        function startCall() {
            const selectedCallType = document.getElementById('network').value;
            let mscContainer = document.getElementById('callFlowDiagram');
            mscContainer.innerHTML = ''; // Clear previous diagram

            // Create the SVG container for the diagram
            let svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            svg.setAttribute("width", "800");
            svg.setAttribute("height", "200");

            // Define arrowhead marker
            let defs = document.createElementNS("http://www.w3.org/2000/svg", "defs");
            let marker = document.createElementNS("http://www.w3.org/2000/svg", "marker");
            marker.setAttribute("id", "arrowhead");
            marker.setAttribute("markerWidth", "10");
            marker.setAttribute("markerHeight", "7");
            marker.setAttribute("refX", "9");
            marker.setAttribute("refY", "3.5");
            marker.setAttribute("orient", "auto");
            let polygon = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
            polygon.setAttribute("points", "0 0, 10 3.5, 0 7");
            marker.appendChild(polygon);
            defs.appendChild(marker);
            svg.appendChild(defs);

            // Function to add vertical lines for entities
            function addLine(x, y1, y2) {
                let line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", x);
                line.setAttribute("y1", y1);
                line.setAttribute("x2", x);
                line.setAttribute("y2", y2);
                line.setAttribute("class", "msc-line");
                svg.appendChild(line);
            }

            // Function to add text labels for entities
            function addText(x, y, textContent) {
                let text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                text.setAttribute("x", x);
                text.setAttribute("y", y);
                text.setAttribute("class", "msc-label");
                text.textContent = textContent;
                svg.appendChild(text);
            }

            // Function to add messages (arrows between entities)
            function addMessage(x1, y1, x2, y2, label) {
                let line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", x1);
                line.setAttribute("y1", y1);
                line.setAttribute("x2", x2);
                line.setAttribute("y2", y2);
                line.setAttribute("class", "msc-arrow");
                svg.appendChild(line);

                let text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                text.setAttribute("x", (x1 + x2) / 2);
                text.setAttribute("y", (y1 + y2) / 2 - 5);
                text.setAttribute("class", "msc-label");
                text.textContent = label;
                svg.appendChild(text);
            }

            // Define entities and their labels
            addLine(50, 20, 180);
            addLine(200, 20, 180);
            addLine(350, 20, 180);
            addLine(500, 20, 180);
            addLine(650, 20, 180);

            addText(40, 15, 'UE');
            addText(190, 15, 'PCSCF');
            addText(340, 15, 'ICSCF');
            addText(490, 15, 'SCSCF');
            addText(640, 15, 'HSS');

            // Add messages based on selected call type
            if (selectedCallType === 'Registration') {
                addMessage(50, 50, 200, 50, 'Register');
                addMessage(200, 80, 350, 80, 'Register');
                addMessage(350, 110, 500, 110, 'UAR');
                addMessage(500, 140, 650, 140, 'UAA');
                addMessage(650, 170, 800, 170, 'UAA');
            } else if (selectedCallType === 'Third-party Registration') {
                addMessage(50, 50, 200, 50, 'Register');
                addMessage(200, 80, 350, 80, 'Register');
                addMessage(350, 110, 500, 110, 'UAR');
                addMessage(500, 140, 650, 140, 'UAA');
                addMessage(650, 170, 800, 170, 'UAA');
            }

            // Append the diagram to the container
            mscContainer.appendChild(svg);
            document.getElementById('callStatus').textContent = `${selectedCallType} Call Flow Started`;
        }
    </script>

</body>
</html>
